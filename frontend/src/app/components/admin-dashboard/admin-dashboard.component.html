<h1>Panel administracyjny</h1>

<button mat-raised-button color="primary" [routerLink]="['/admin', 'add-animal']">Dodaj zwierzę</button>

<table mat-table [dataSource]="animals">

  <ng-container matColumnDef="id">
    <th mat-header-cell *matHeaderCellDef> ID</th>
    <td mat-cell *matCellDef="let animal"> {{ animal.id }}</td>
  </ng-container>

  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef> Imię</th>
    <td mat-cell *matCellDef="let animal"> {{ animal.name }}</td>
  </ng-container>


  <ng-container matColumnDef="species">
    <th mat-header-cell *matHeaderCellDef> Gatunek</th>
    <td mat-cell *matCellDef="let animal"> {{ animal.species.name }}</td>
  </ng-container>

  <ng-container matColumnDef="morph">
    <th mat-header-cell *matHeaderCellDef> Umaszczenie</th>
    <td mat-cell *matCellDef="let animal">
      @for (morph of animal.morphs; track $index) {
        <span>{{ morph.name }} </span>
      }
    </td>
  </ng-container>

  <ng-container matColumnDef="forSale">
    <th mat-header-cell *matHeaderCellDef> Na sprzedarz</th>
    <td mat-cell *matCellDef="let animal">
      @if (animal.animalForSale) {
        <span>Tak</span>
      } @else {
        <span>Nie</span>
      }
    </td>
  </ng-container>

  <ng-container matColumnDef="reservationStatus">
    <th mat-header-cell *matHeaderCellDef> Status rezerwacji</th>
    <td mat-cell *matCellDef="let animal">
      @if (animal.animalForSale) {
        <span>{{ animal.animalForSale.reservationStatus }}</span>
      }
    </td>
  </ng-container>

  <ng-container matColumnDef="price">
    <th mat-header-cell *matHeaderCellDef> Cena</th>
    <td mat-cell *matCellDef="let animal">
      @if (animal.animalForSale) {
        <span>{{ animal.animalForSale.price }}</span>
      }
    </td>
  </ng-container>

  <ng-container matColumnDef="actions">
    <th mat-header-cell *matHeaderCellDef> Akcje</th>
    <td mat-cell *matCellDef="let animal">
      @if (animal.animalForSale) {
        <button mat-button color="primary"
                [disabled]="animal.animalForSale.reservationStatus === reservationStatus.for_sale"
                (click)="updateReservationStatus(animal.id,reservationStatus.for_sale)">
          Na sprzedarz
        </button>
        <button mat-button color="primary"
                [disabled]="animal.animalForSale.reservationStatus === reservationStatus.reserved"
                (click)="updateReservationStatus(animal.id,reservationStatus.reserved)">
          Zarezerwowane
        </button>
        <button mat-button color="primary"
                [disabled]="animal.animalForSale.reservationStatus === reservationStatus.sold"
                (click)="updateReservationStatus(animal.id,reservationStatus.sold)">
          Sprzedane
        </button>
      }
      <button mat-button color="primary" [routerLink]="['/admin-dashboard', 'edit-animal', animal.id]">Edytuj</button>
      <button mat-button color="warn" (click)="deleteAnimal(animal.id)">Usuń</button>
    </td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

</table>
